% Copyright 2018 Google LLC
%
% Use of this source code is governed by an MIT-style
% license that can be found in the LICENSE file or at
% https://opensource.org/licenses/MIT.

%%% script AUTHOR: Paul Crowley, Eric Biggers%%%
%%% script TITLE: {Adiantum}: length-preserving encryption for entry-level processors%%%

%!TeX spellcheck = en-US

\RequirePackage{etex}
\RequirePackage{etoolbox}
\newtoggle{iacr}
\input{work/toggle.tex}
\iftoggle{iacr}{
    \documentclass[journal=tosc,preprint,floatrow,submission]{iacrtrans}
}{ % iacr

    \documentclass[letterpaper,luatex,11pt]{article}

    \usepackage{fontspec}
    \setmainfont{TeX Gyre Pagella}
    \setsansfont{TeX Gyre Heros}
    \setmathrm{Latin Modern Roman}
    \defaultfontfeatures{}
    \setmonofont{TeX Gyre Cursor}[Ligatures={NoCommon,NoRequired,NoContextual},Scale=0.9]

    \usepackage[hmargin=4cm,vmargin=3cm,nohead]{geometry}
    \usepackage{parskip}
    \usepackage[style]{abstract}
    \usepackage{titling}
    \usepackage{sectsty}
    \usepackage{authblk}
    \usepackage{floatrow}
    \usepackage[svgnames]{xcolor}
    \usepackage[breaklinks,colorlinks,urlcolor=DarkBlue,linkcolor=DarkRed,citecolor=DarkGreen,pdfencoding=unicode]{hyperref}

    \pretitle{\begin{center}\LARGE\bfseries\sffamily} % sf title
    \renewcommand{\abstitlestyle}{\sffamily\bfseries\centering} % sf abstract
    \allsectionsfont{\sffamily} % sf sections

    \raggedright
    \raggedbottom

} % non-iacr

\usepackage[style=alphabetic,backend=biber]{biblatex}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage[logic,probability,advantage,adversary,landau,sets,operators]{cryptocode}
\usepackage{algpseudocode}

\usepackage{tikz}
\usepackage{makecell}

\usepackage{longtable}

\DeclareMathOperator{\GF}{GF}
\DeclareMathOperator{\XChaCha12}{XChaCha12}
\DeclareMathOperator{\HBSH}{HBSH}
\DeclareMathOperator{\Polydjb}{Poly1305}

\DeclareMathOperator{\NH}{NH}
\DeclareMathOperator{\intify}{int}
\DeclareMathOperator{\fromint}{fromint}
\DeclareMathOperator{\pad}{pad}

\addbibresource{bib.bib}

\usetikzlibrary{positioning}
\usetikzlibrary{groupops}

\newcommand*{\arrowoplus}{\leftarrow\mkern-12mu\oplus}
\newcommand*{\xprm}[2]{\textsf{\ref*{#1}-#2}}
\newcommand*{\xprmtitle}[2]{\textbf{\xprm{#1}{#2}}}
\newcommand*{\calE}{\mathcal{E}}
\newcommand*{\calD}{\mathcal{D}}
\newcommand*{\barE}{\overline{\calE}}
\newcommand*{\barD}{\overline{\calD}}

\title{{Adiantum}: length-preserving encryption for entry-level processors}
\iftoggle{iacr}{
    \author{Paul~Crowley \and Eric~Biggers}
    \institute{Google LLC \\ \email[paulcrowley@google.com,ebiggers@google.com]{{paulcrowley,ebiggers}@google.com}}
}{ % iacr
    \author{Paul~Crowley}
    \author{Eric~Biggers}
    \affil{Google LLC}
} % non-iacr

\tikzset{cbox/.style={
        rectangle,
        thick,
        draw,
        minimum height=1cm,
        text centered,
        anchor=center,
        rounded corners=2pt,
    }
}

\begin{document}
\maketitle
\iftoggle{iacr}{
    \keywords{strong pseudorandom permutation \and
        variable input length \and
        tweakable encryption \and
        disk encryption}
}{ % iacr
} % non-iacr

\begin{abstract}
    We present HBSH, a simple construction for tweakable length-preserving encryption which
    directly supports the fastest options for hashing and stream encryption for processors
    without AES or other crypto instructions, with a provable
    quadratic advantage bound. Our composition Adiantum uses NH, Poly1305, XChaCha12,
    and a single AES invocation. On an ARM Cortex-A7 processor, Adiantum decrypts
    4096-byte messages at 10.6 cycles per byte, over five times faster than
    AES-256-XTS, with a constant-time implementation. We also define HPolyC which is
    simpler and has excellent key agility at 13.6 cycles per byte.
\iftoggle{iacr}{
}{

    This paper: \url{https://ia.cr/2018/720} \\
    Source: \url{https://github.com/google/adiantum} \\
    Email: \href{mailto:paulcrowley@google.com,ebiggers@google.com}{\{paulcrowley,ebiggers\}@google.com}
}
\end{abstract}

\input{introduction.tex}
\input{specification.tex}
\input{design.tex}
\input{performance.tex}
\input{proof.tex}
\printbibliography
\appendix
\input{hashing.tex}
\vspace*{\fill}
Version: \texttt{\input{work/git.tex}}
\end{document}
